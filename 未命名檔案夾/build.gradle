apply plugin: 'com.android.application'
apply from: "${project.rootDir}/myConfigs/utils.gradle"
apply plugin: 'kotlin-android'

apply plugin: 'kotlin-android-extensions'

android {//
    sourceSets {
        main {
            manifest.srcFile 'src/main/AndroidManifests.xml'
            jniLibs.srcDirs = ['libs']
        }
    }
    packagingOptions{
        doNotStrip "*/armeabi/*.so"
        doNotStrip "*/armeabi-v7a/*.so"
        doNotStrip "*/arm64-v8a/*.so"
        doNotStrip "*/x86/*.so"
        doNotStrip "*/x86_64/*.so"
    }

    compileSdkVersion rootProject.compileSdkVersion
    //buildToolsVersion rootProject.buildToolsVersion
    defaultConfig {
        applicationId "com.bok.cordova"
        minSdkVersion 23
        targetSdkVersion rootProject.compileSdkVersion
        versionCode 167
        //versionName太長 會影響推播，ex:7.0.17.01 推播會收不到，或發送到曾經註冊過的手機中
        versionName "8.0.02"
        multiDexEnabled true
        resValue "string", "app_name", "高銀行動e點通"
        def AES_PRIVATE_KEY = "mitake@@86136982mitake@@86136982"
        buildConfigField 'String', 'AES_PRIVATE_KEY', toJavaCodeString(AES_PRIVATE_KEY)
        def DOMAIN_NAME = "mtapp.bok.com.tw"
        buildConfigField 'String', 'DOMAIN_NAME', toJavaCodeString(DOMAIN_NAME)
        def KK_VERSION_NAME = "1.0"
        buildConfigField 'String', 'KK_VERSION_NAME', toJavaCodeString(KK_VERSION_NAME)
        def PUSH_AES_PRIVATE_KEY = "bankofkaohsiung@APP|07-3840888##"
        buildConfigField 'String', 'PUSH_AES_PRIVATE_KEY', toJavaCodeString(PUSH_AES_PRIVATE_KEY)

        resValue "string", "DEEP_LINK_SCHEME", "bokmobile"
        resValue "string", "DEEP_LINK_URL", "bok.com.tw"
//        jackOptions {
//            enabled true
//        }
        ndk {
            //abiFilters 'x86', 'armeabi', 'armeabi-v7a'
            abiFilters "armeabi", "armeabi-v7a", "arm64-v8a", "x86", "x86_64"
            debugSymbolLevel 'FULL'
        }
        testInstrumentationRunner = 'androidx.test.runner.AndroidJUnitRunner'

        //default config
        buildConfigField('String', 'DOMAIN', '"https://mbgateway.bok.com.tw"')
        buildConfigField('String', 'PATH', '"/BOKMobileGateway"')
        buildConfigField('String', 'pushUrlHost', '"https://MBNewPush.bok.com.tw"')
        buildConfigField('String', 'PUSH_PATH', '""')
        buildConfigField('String', 'CHK_PATH', '"/BOKMobileCheck/rest"')
        buildConfigField('String', 'easyInfoUrl', '"https://ezinfo.mitake.com.tw:443/easyInfo/www/#/home/kATQfNxghj"')
        buildConfigField('String', 'accessibilityUrl', '"https://sib.bok.com.tw/SIB/common/Login.xhtml"')
        buildConfigField('boolean', 'isShowLog', 'false')
        buildConfigField('boolean', 'isDebug', 'false')
        buildConfigField('boolean', 'isTestSessionCountDown', 'false')
        buildConfigField('boolean', 'isSecurityTest', 'false')
        buildConfigField('boolean', 'isDeepLinkEnabled', 'false')
        buildConfigField('String', 'cert', '"mbgateway.bok.cer"')
        buildConfigField('String', 'oldCert', '"mbgateway.bok.old.cer"')
        buildConfigField('boolean', 'isMultiLanguage', 'true')
        buildConfigField('boolean', 'isQuickIdKeyStore', 'true')
        buildConfigField('String', 'oldPushUrlHost', '"https://mbpush.bok.com.tw"')
        buildConfigField('String', 'PUSH_TOKEN_ID', '"1AFD8275-2A3F-4AB9-817A-BEDFFFAFA176"')
        buildConfigField('String', 'PUSH_APP_ID', '"1"')
    }

    flavorDimensions "dev"
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
        debug {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }

    productFlavors {
        production {
            applicationId = "com.bok.cordova"
            resValue "string", "app_name", "高銀行動e點通"
            buildConfigField('String', 'DOMAIN', '"https://mbgateway.bok.com.tw"')
            buildConfigField('String', 'PATH', '"/BOKMobileGateway"')

            // 推播
            //buildConfigField('String', 'pushUrlHost', '"https://mbpush.bok.com.tw"')
            //buildConfigField('String', 'PUSH_TOKEN_ID', '"5353A995-A273-4FF1-8A49-2902B13FA26C"')
            //new push start
            buildConfigField('String', 'pushUrlHost', '"https://MBNewPush.bok.com.tw"')
            buildConfigField('String', 'PUSH_TOKEN_ID', '"1AFD8275-2A3F-4AB9-817A-BEDFFFAFA176"')
            //new push end
            buildConfigField('String', 'PUSH_APP_ID', '"1"')
            buildConfigField('String', 'PUSH_PATH', '""')
            buildConfigField('String', 'CHK_PATH', '"/BOKMobileCheck/rest"')
            //

            buildConfigField('String', 'easyInfoUrl', '"https://ezinfo.mitake.com.tw:443/easyInfo/www/#/home/kATQfNxghj"')
            buildConfigField('String', 'accessibilityUrl', '"https://sib.bok.com.tw/SIB/common/Login.xhtml"')
            buildConfigField('boolean', 'isShowLog', 'false')
            buildConfigField('boolean', 'isDebug', 'false')
            buildConfigField('boolean', 'isTestSessionCountDown', 'false')
            buildConfigField('boolean', 'isDeepLinkEnabled', 'true')
            buildConfigField('String', 'oldPushUrlHost', '"https://mbpush.bok.com.tw"')
        }
        tdcc {
            applicationId = "com.bok.cordova"
            resValue "string", "app_name", "高銀集保TSP測試"
            buildConfigField('String', 'DOMAIN', '"https://mbgwtest.bok.com.tw"')
            buildConfigField('String', 'PATH', '"/BOKMobileGateway"')
            buildConfigField('String', 'pushUrlHost', '"https://mbpush.bok.com.tw"')
            buildConfigField('String', 'PUSH_PATH', '""')
            buildConfigField('String', 'CHK_PATH', '"/BOKMobileCheck/rest"')
            buildConfigField('String', 'easyInfoUrl', '"https://ezinfo.mitake.com.tw:443/easyInfo/www/#/home/kATQfNxghj"')
            buildConfigField('String', 'accessibilityUrl', '"https://sib.bok.com.tw/SIB/common/Login.xhtml"')
            buildConfigField('boolean', 'isShowLog', 'false')
            buildConfigField('boolean', 'isDebug', 'false')
            buildConfigField('boolean', 'isTestSessionCountDown', 'false')
            buildConfigField('boolean', 'isDeepLinkEnabled', 'true')
        }
        securityTest {
            buildConfigField('boolean', 'isSecurityTest', 'true')
            buildConfigField('boolean', 'isShowLog', 'false')
            buildConfigField('boolean', 'isDebug', 'false')
        }
        bokdev {
            applicationId = "bok.mitake.com.bokmbank.dev"
            resValue "string", "app_name", "高銀(dev)"

            // Domain
            //buildConfigField('String', 'DOMAIN', '"https://mbgwtest.bok.com.tw"') // 高銀測試
            buildConfigField('String', 'DOMAIN', '"https://mbgatewayt.bok.com.tw"')
//            buildConfigField('String', 'DOMAIN', '"http://10.1.100.181:8086"') // 三竹測試
            buildConfigField('String', 'PATH', '"/BOKMobileGateway"')

            // 推播
            buildConfigField('String', 'pushUrlHost', '"https://pushapt.bok.com.tw"') // 高銀測試
            //buildConfigField('String', 'pushUrlHost', '"https://mbpusht.bok.com.tw"')
            //buildConfigField('String', 'pushUrlHost', '"http://10.3.9.29"')
            buildConfigField('String', 'oldPushUrlHost', '"https://mbpusht.bok.com.tw"')
            buildConfigField('String', 'PUSH_TOKEN_ID', '"CED8AB6D-BD26-4FC6-AEAE-6FE8E76BFF36"') // 高銀測試
            buildConfigField('String', 'PUSH_APP_ID', '"1"') // 高銀測試

//            buildConfigField('String', 'pushUrlHost', '"https://appdemo1.mitake.com.tw"') // 三竹測試
//            buildConfigField('String', 'PUSH_TOKEN_ID', '"CFBAD9D1-D22B-4D83-9901-406367B1F349"') // 三竹測試
//            buildConfigField('String', 'PUSH_APP_ID', '"19"') // 三竹測試

            buildConfigField('String', 'PUSH_PATH', '""')
            buildConfigField('String', 'CHK_PATH', '"/BOKMobileCheck/rest"')

            buildConfigField('String', 'easyInfoUrl', '"https://newservices.mitake.com.tw:8443/easyInfo/www/#/home/kATQfNxghj"')
            buildConfigField('String', 'accessibilityUrl', '"https://sib.bok.com.tw/SIB/common/Login.xhtml"')
            buildConfigField('boolean', 'isShowLog', 'true')
            buildConfigField('boolean', 'isDebug', 'true')
            buildConfigField('boolean', 'isTestSessionCountDown', 'false')
            buildConfigField('boolean', 'isDeepLinkEnabled', 'true')
            //buildConfigField('String', 'cert', '"bok.com.tw.cer"')
        }
        /*
        dev {
            applicationId = "bok.mitake.com.bokmbank.dev"
            resValue "string", "app_name", "高銀行動e點通dev"
            buildConfigField('String', 'DOMAIN', '"http://10.1.16.213:8180"')
            buildConfigField('String', 'PATH', '"/BOKMobileGateway"')
            buildConfigField('String', 'pushUrlHost', '"http://220.128.150.80"')
            buildConfigField('String', 'PUSH_PATH', '"/MtkPushWebBOK/rest"')
            buildConfigField('String', 'easyInfoUrl', '"https://newservices.mitake.com.tw:8443/easyInfo/www/#/home/kATQfNxghj"')
            buildConfigField('boolean', 'isShowLog', 'true')
            buildConfigField('boolean', 'isDebug', 'true')
            buildConfigField('boolean', 'isTestSessionCountDown', 'false')
        }
        uat {
            applicationId = "bok.mitake.com.bokmbank.uat"
            resValue "string", "app_name", "高銀行動e點通uat"

            // ********** domain **********
//            buildConfigField ('String', 'DOMAIN', '"https://mbwebt.bok.com.tw"') // 高銀測試
//            buildConfigField ('String', 'DOMAIN', '"https://mbweb.bok.com.tw"') // 高銀正式
//            buildConfigField ('String', 'DOMAIN', '"http://104.199.180.73:8080"') // 雲端
//            buildConfigField ('String', 'DOMAIN', '"http://172.20.10.4:8180"') // light
//            buildConfigField ('String', 'DOMAIN', '"http://10.1.16.160:8080"') // morrishsu
//            buildConfigField ('String', 'DOMAIN', '"http://172.20.10.2:1222"') // 雅勵
//            buildConfigField ('String', 'DOMAIN', '"http://10.1.100.169:8081"') // 公司
//            buildConfigField ('String', 'DOMAIN', '"http://220.128.150.80:80"') // 公司對外
//            buildConfigField ('String', 'DOMAIN', '"http://220.128.150.80"') // 公司對外
            buildConfigField('String', 'DOMAIN', '"https://newservices.mitake.com.tw:8443"')
            // https 測試
//            buildConfigField ('String', 'DOMAIN', '"http://192.168.43.165:8180"') // 冠志
//            buildConfigField ('String', 'DOMAIN', '"http://10.1.16.115:8180"') // nLogin 測試
//            buildConfigField ('String', 'DOMAIN', '"http://10.1.16.214:8080"') // kennychao

            buildConfigField('String', 'PATH', '"/BOKMobileGateway"')
//            buildConfigField ('String', 'PATH', '"/BOKMobileWeb"') // light
            // ****************************

            // ********** push **********
//            buildConfigField ('String', 'pushUrlHost', '"https://mbpush.bok.com.tw"') // 高銀正式
//            buildConfigField ('String', 'pushUrlHost', '"https://mbpusht.bok.com.tw"') // 高銀測試
            buildConfigField('String', 'pushUrlHost', '"http://220.128.150.80"')

//            buildConfigField ('String', 'PUSH_PATH', '"/MtkPushWeb/rest"')
            buildConfigField('String', 'PUSH_PATH', '"/MtkPushWebBOK/rest"')
            // **************************

            buildConfigField('String', 'easyInfoUrl', '"https://ezinfo.mitake.com.tw:443/easyInfo/www/#/home/kATQfNxghj"')
            buildConfigField('String', 'accessibilityUrl', '"https://sib.bok.com.tw/SIB/common/Login.xhtml"')
            buildConfigField('boolean', 'isShowLog', 'true')
            buildConfigField('boolean', 'isDebug', 'true')
            buildConfigField('boolean', 'isTestSessionCountDown', 'false')
        }
        */
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
//    compileOptions {
//        sourceCompatibility JavaVersion.VERSION_1_8
//        targetCompatibility JavaVersion.VERSION_1_8
//        incremental false
////        targetCompatibility 1.8
////        sourceCompatibility 1.8
//    }
}

repositories {
    flatDir {
        dirs 'libs'
    }
}

dependencies {
    implementation fileTree(include: ['*.jar'], dir: 'libs')
    implementation fileTree(include: ['*.aar'], dir: 'libs')
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version"
    implementation "androidx.appcompat:appcompat:$androidXLibraryVersion"
    implementation 'com.google.code.gson:gson:2.8.9'
    implementation 'com.facebook.android:facebook-share:[4,5)'
    implementation 'com.airbnb.android:lottie:2.2.5'

    //FCM
    implementation platform('com.google.firebase:firebase-bom:30.5.0')
    implementation 'com.google.firebase:firebase-messaging'
    //for crashlytics
    implementation('com.google.firebase:firebase-core:16.0.8') {
        exclude module: "play-services-ads-identifier"
        exclude module: "play-services-measurement"
        exclude module: "play-services-measurement-sdk"
    }

    // play services
    implementation 'com.google.android.gms:play-services-vision:17.0.2'
    implementation 'com.google.android.gms:play-services-maps:19.0.0'
    implementation 'com.google.android.gms:play-services-location:16.0.0'

    // PUSH LIB使用
    //implementation 'org.jsoup:jsoup:1.11.2'
    implementation 'androidx.annotation:annotation:1.0.0'
    implementation 'com.scottyab:aes-crypto:0.0.4'

    implementation project(path: ':gridmenu')
    implementation project(path: ':TextSizeHelper')
    implementation 'androidx.constraintlayout:constraintlayout:2.0.1'
    //implementation 'androidx.appcompat:appcompat:1.0.0-beta01'
    //androidTestImplementation 'androidx.test.espresso:espresso-core:3.3.0-rc01'
    //androidTestImplementation 'androidx.test:rules:1.3.0-rc01'

    //crop
    //api 'com.theartofdev.edmodo:android-image-cropper:2.8.+'
    implementation "androidx.exifinterface:exifinterface:$androidXLibraryVersion"
    implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core:1.3.2'
    implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-android:1.3.2'

    //implementation 'com.github.bumptech.glide:glide:4.11.0'
    //annotationProcessor 'com.github.bumptech.glide:compiler:4.11.0'

    //crashlytics
    implementation('com.google.firebase:firebase-crashlytics:17.3.1') {
        exclude module: "play-services-ads-identifier"
        exclude module: "play-services-measurement"
        exclude module: "play-services-measurement-sdk"
    }

    implementation('com.google.firebase:firebase-dynamic-links:21.0.2') {
        exclude module: "play-services-ads-identifier"
        exclude module: "play-services-measurement"
        exclude module: "play-services-measurement-sdk"
    }
    implementation('com.google.firebase:firebase-analytics:18.0.2') {
        exclude module: "play-services-ads-identifier"
        exclude module: "play-services-measurement"
        exclude module: "play-services-measurement-sdk"
    }

    implementation 'androidx.biometric:biometric:1.1.0'

    //inAppUpdates
    implementation 'com.google.android.play:core:1.10.0'

    //root checker
    implementation 'com.scottyab:rootbeer-lib:0.1.0'

    //barcode scanner
    implementation 'com.tbruyelle.rxpermissions2:rxpermissions:0.9.4@aar'
    implementation 'io.reactivex.rxjava2:rxjava:2.1.6'

    //implementation 'com.github.javiersantos:PiracyChecker:1.2.8'

    implementation 'com.google.android.material:material:1.0.0'
    implementation("androidx.recyclerview:recyclerview:1.2.0")

    implementation('com.journeyapps:zxing-android-embedded:4.3.0') { transitive = false }
    implementation 'com.google.zxing:core:3.3.0'

    //implementation 'org.springframework.android:spring-android-core:1.0.1.RELEASE'
    //implementation("com.squareup.okhttp3:okhttp:4.10.0")

    //廣告
    //implementation 'androidx.ads:ads-identifier:1.0.0-alpha01'
    //implementation 'com.google.guava:guava:28.0-android'
    //implementation 'com.google.android.gms:play-services-ads-identifier:16.0.0'

    // For pushsdkv2
    implementation 'com.squareup.okhttp3:okhttp:4.2.1'
    implementation 'com.squareup.okhttp3:logging-interceptor:4.2.1'
    implementation 'com.squareup.retrofit2:retrofit:2.6.0'
    implementation 'com.squareup.retrofit2:converter-gson:2.6.0'
}

task srcZip(type: Zip) {
    baseName = 'bok-project'
    from projectDir
    exclude '*.iml', 'import-summary.txt', 'local.properties',
            '.gradle/', '.idea/', 'build/', '.svn/', '.DS_Store'
}

apply plugin: 'com.google.gms.google-services'
apply plugin: 'com.google.firebase.crashlytics'
apply from: 'e.gradle'